<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Majid Khoshrou – Data Scientist specialized in machine learning, forecasting, and real-time analytics." />
  <meta http-equiv="pragma" content="no-cache"/>
  <meta property="og:title" content="Majid Khoshrou - Ask Mr M">
  <meta property="og:description" content="Forecasting, machine learning, and real-time analytics in energy & mobility.">
  <meta property="og:image" content="{{ url_for('static', filename='images/majid_tudelft_02.png', _external=True) }}">
  <meta property="og:type" content="website">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/chat-style.css') }}">
  <title>Majid Khoshrou - Ask Mr M</title>
  <link rel="icon" href="{{ url_for('static', filename='images/MK.jpeg') }}">
  
  <script>
    // Inject from env; leave empty in local if you use dev bypass
    window.TURNSTILE_SITE_KEY = "{{ TURNSTILE_SITE_KEY | default('', true) }}";
    window.TURNSTILE_ACTION = "chat";
  </script>
  <script>
    if (window.TURNSTILE_SITE_KEY) {
      const s = document.createElement('script');
      s.src = "https://challenges.cloudflare.com/turnstile/v0/api.js";
      s.async = true; s.defer = true;
      document.head.appendChild(s);
    }
  </script>


</head>
<body>
  <header>
    <div class="header-container">
      <img src="{{ url_for('static', filename='images/majid_tudelft_02.png') }}" alt="Majid Khoshrou" class="profile-photo">
      <h1>Majid Khoshrou</h1>
      <p>Data Scientist | Machine Learning | Generative AI | Real-Time Analytics</p>
    </div>
    <nav>
      <ul>
        <li><a href="{{ url_for('home') }}" class="{% if request.endpoint == 'home' %}active{% endif %}">Home</a></li>
        <li><a href="{{ url_for('research') }}" class="{% if request.endpoint == 'research' %}active{% endif %}">Publications</a></li>
        <li><a href="{{ url_for('projects') }}" class="{% if request.endpoint == 'projects' %}active{% endif %}">Projects</a></li>
        <li><a href="{{ url_for('talks') }}" class="{% if request.endpoint == 'talks' %}active{% endif %}">Talks</a></li>
        <li><a href="{{ url_for('analytics') }}" class="{% if request.endpoint == 'analytics' %}active{% endif %}">Analytics</a></li>
        <li><a href="{{ url_for('ask_mr_m') }}" class="{% if request.endpoint == 'ask_mr_m' %}active{% endif %}">Ask Mr M</a></li>
        <li><a href="{{ url_for('contact') }}" class="{% if request.endpoint == 'contact' %}active{% endif %}">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="chat-container">
      <h2 class="assistant-header">Talk to Mr M — Majid's custom-trained AI Assistant</h2>

      <!-- Mr M intro block -->
    <div class="assistant-intro">
      <img src="{{ url_for('static', filename='images/ai-assistant.png') }}" alt="Mr M Avatar" class="assistant-avatar">
      <div>
        <p><strong>Mr M</strong> is Majid's custom-trained AI assistant. Curious about my research, background, or projects? Just ask!</p>
        <p class="example-questions"><em>
          Example questions:<br>
          “Tell me about his work at Alliander”<br>
          “What projects has he done in energy forecasting?”
        </em></p>
      </div>
    </div>

    <div id="quota-banner" class="quota-banner"></div>


      <!-- Chat messages go here -->
      <div id="chat-window" class="chat-window">
        <div class="message-row assistant">
          <img src="{{ url_for('static', filename='images/ai-assistant.png') }}"  alt="Assistant Avatar" class="avatar">
          <div class="message assistant">
            Hello! I'm <strong>Mr M</strong>, Majid’s professional AI assistant.<br>
            Ask me anything about his background, work, research, or publications.
          </div>
        </div>
      </div>

      <!-- Chat input -->
      <div class="chat-input">
        <input type="text" id="user-input" placeholder="Type your question..." aria-label="Chat input field" />
        <button id="send-button" aria-label="Send message">Send</button>
      </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 Majid Khoshrou</p>
    <div class="social-links">
      <a href="https://www.linkedin.com/in/majid-khoshrou-a2728349/" target="_blank">LinkedIn</a> |
      <a href="https://scholar.google.com/citations?user=RPdtjy0AAAAJ&hl=nl&oi=ao" target="_blank">Google Scholar</a> |
      <a href="https://github.com/majidkhoshrou" target="_blank">GitHub</a>
    </div>
  </footer>

    <script>
    const params = new URLSearchParams(window.location.search);
    const prefill = params.get("query");
    if (prefill) {
      const inputEl = document.getElementById("user-input");
      inputEl.value = prefill;
      inputEl.focus();

      // Optional: Auto-send message to Mr M
      // setTimeout(() => document.getElementById("send-button").click(), 600);
    }
    </script>


  <script src="{{ url_for('static', filename='js/chat.js') }}"></script>

  <script> fetch("/api/log-visit", { method: "POST" }); </script>

</body>
</html>
